<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <meta name="description" content="CDx">
  <meta property="og:title" content="CLIPDrawX"/>
  <meta property="og:description" content="Primitive-based Explanations for Text Guided Sketch Synthesis"/>
  <meta property="og:url" content="clipdrawx.github.io"/>

  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="CLIPDrawX,Sketch,Synthesis,Explainability,Explainable Sketching">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <link rel="icon" type="image/x-icon" href="static/images/CDx-Logo.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Hedvig+Letters+Serif:opsz@12..24&display=swap" rel="stylesheet">
    <title>CLIPDrawX: Primitive-based Explanations for Text Guided Sketch Synthesis</title>
    
  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>

  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">CLIPDrawX: Primitive-based Explanations for Text Guided Sketch Synthesis</h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="https://nityanandmathur.live" target="_blank">Nityanand Mathur</a><sup>*,1</sup>,</span>
                <span class="author-block">
                  <a href="https://github.com/shyammarjit" target="_blank">Shyam Marjit</a><sup>*,1</sup>,</span>
                  <span class="author-block">
                    <a href="https://sites.google.com/view/abhrachaudhuri/" target="_blank">Abhra Chaudhury</a><sup>2</sup> ,
                  </span>
                  <span class="author-block">
                    <a href="https://sites.google.com/site/2adutta/" target="_blank">Anjan Dutta</a><sup>3</sup>
                  </span>
                  </div>  

                  <div class="is-size-5 publication-authors">
                    <span class="author-block"><sup>1</sup>IIIT Guwahati, <sup>2</sup>University of Exeter, <sup>3</sup>University Of Surrey</span>
                    <span class="eql-cntrb"><small><br><sup>*</sup>Indicates Equal Contribution</small></span>
                  </div>
                  
                  <div class="column has-text-centered">
                    <div class="publication-links">
                         <!-- Arxiv PDF link -->
                      <span class="link-block">
                        <a href="https://arxiv.org/abs/2312.02345" target="_blank"
                        class="external-link button is-normal is-rounded is-dark">
                        <span class="icon">
                          <i class="fas fa-file-pdf"></i>
                        </span>
                        <span>Paper(soon)</span>
                      </a>
                    </span>

                    <!-- Supplementary PDF link
                    <span class="link-block">
                      <a href="static/pdfs/supplementary_material.pdf" target="_blank"
                      class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="fas fa-file-pdf"></i>
                      </span>
                      <span>Supplementary</span>
                    </a>
                  </span> -->

                  <!-- Github link -->
                  <span class="link-block">
                    <a href="https://github.com/clipdrawx/clipdrawx.github.io/" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code(Soon)</span>
                  </a>
                </span>

                <!-- ArXiv abstract Link -->
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2312.02345" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>

                <span class="link-block">
                  <a href="gallery.html" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="fa fa-play"></i>
                  </span>
                  <span>Gallery</span>
                </a>
              </span>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<hr class="divider" />
<!-- Teaser video-->
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video poster="" id="tree" autoplay controls loop muted height="100%">
        <!-- Your video here -->
        <source src="static/images/CLIPDrawX.mp4"
        type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        Our method, CLIPDrawX synthesizes vector sketches conditioned on an input text prompt using simple primitive shapes like
        <span style="color: blue;">circle</span>, <span style="color: red;">straight lines</span>, and <span style="color: rgb(95, 228, 95);">semi-circles</span>, with the highlighted words used to create the cross-attention maps.
        
      </h2> 
    </div>
  </div>
</section>
<!-- End teaser video -->
<hr class="divider" />
<!-- Paper abstract -->
<section class="section hero">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Concise Overview</h2>
        <div class="content has-text-justified">
          <p>
            With the goal of understanding the visual concepts that
            CLIP associates with text prompts, we show that the latent
            space of CLIP can be visualized solely in terms of linear
            transformations on simple geometric primitives like circles
            and straight lines. Although existing approaches achieve
            this by sketch-synthesis-through-optimization, they do so
            on the space of Bézier curves, which exhibit a wastefully
            large set of structures that they can evolve into, as most of
            them are non-essential for generating meaningful sketches.
            We present CLIPDrawX, an algorithm that provides significantly
            better visualizations for CLIP text embeddings, using
            only simple primitive shapes like straight lines and circles.
            This constrains the set of possible outputs to linear transformations
            on these primitives, thereby exhibiting an inherently
            simpler mathematical form. The synthesis process of
            CLIPDrawX can be tracked end-to-end, with each visual
            concept being explained exclusively in terms of primitives.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->

<hr class="divider">
<section class="section hero">
  <div class="container is-max-desktop">
    <div class="section-title has-text-centered is-centered">
      <h2 class="title is-3">From Prose to Portraits: Mechanism of Sketch Synthesis</h2><br>
    </div>
    <div class="columns is-centered has-text-centered">
      <div class="column  has-text-centered">
          <img id="network" src="static/images/model_dig.png"/>
          <div class="content has-text-justified">
            CLIPDrawX comprises strategic canvas initialization, which utilizes diffusion-based cross-attention maps and a patch-wise
            arrangement of primitives, along with a primitive-level dropout (PLD). The proposed model, coupled with the use of a pre-trained image
            \( \mathcal{I} \) and text \( \mathcal{T} \) encoders from the CLIP model for similarity maximization, positions itself as an efficient and user-friendly tool in the
            realm of AI-driven explainable sketch synthesis. The highlighted word is used to create the cross-attention maps.<br>
            The total loss, \( \mathcal{L}_\text{total} \) is the summation of two loss functions (semantic loss \( \mathcal{L}_\text{sem} \) and visual loss \( \mathcal{L}_\text{vis} \)), each weighted by their respective coefficients, \( \lambda_\text{sem} \) and \( \lambda_\text{vis} \). These two loss functions balance our sketch synthesis process: semantic loss aligns vector sketches with textual prompts, while visual loss maintains low-level spatial features and perceptual coherence. This combination effectively captures the intricate relationship between semantic fidelity and geometric accuracy.
            <br>
            <div style="border: 1px solid black; padding: 1px 10px; margin: 4px auto; display: table;">
              $$\mathcal{L}_\text{total} = \lambda_\text{sem} \mathcal{L}_\text{sem} + \lambda_\text{vis} \mathcal{L}_\text{vis}$$
            </div>
          </div>
      </div>      
  </div>
  </section>

<hr class="divider" />  

<section class="section">
  <div class="container is-widescreen" id="gallery">
    <div class="section-title has-text-centered is-centered">
      <h2 class="title is-3">Unraveling Textual Descriptions into Artistic Creations</h2><br>
    </div>
    <div class="container is-max-desktop is-centered has-text-centered">
      <div class="gallery">
        
        <div class="captioned_video">
          <div class="inner_gallery">
            <img class="gallery_img under grid_r_1 grid_c_1 img-border" src="static/video/A spaceship flying in a starry sky.gif" alt="spaceship"/>
          </div>  
          <h6 class="caption has-tooltip-multiline has-tooltip-bottom">“A spaceship flying[..]” <span class="tooltip-text">“A spaceship flying in a starry sky”</span></h6>
        </div>

        <div class="captioned_video">
          <div class="inner_gallery">
            <img class="gallery_img under grid_r_1 grid_c_1 img-border" src="static/video/astronaut.gif " alt="astronaut"/>
          </div>  
          <h6 class="caption has-tooltip-multiline has-tooltip-bottom">“An astronaut in [..]” <span class="tooltip-text">“An astronaut in space”</span></h6>
        </div>

        <div class="captioned_video">
          <div class="inner_gallery">
            <img class="gallery_img under grid_r_1 grid_c_1 img-border" src="static/video/camp.gif " alt="camp"/>
          </div>  
          <h6 class="caption has-tooltip-multiline has-tooltip-bottom">“A camp in [..]” <span class="tooltip-text">“A camp in wilderness”</span></h6>
        </div>        
        
        <div class="captioned_video">
          <div class="inner_gallery">
            <img class="gallery_img under grid_r_1 grid_c_1 img-border" src="static/video/kitchen.gif " alt="kitchen"/>
          </div>  
          <h6 class="caption has-tooltip-multiline has-tooltip-bottom">“A cozy corner [..]”<span class="tooltip-text">“A cozy corner in the kitchen”</span></h6>
        </div>
        <div class="captioned_video">
          <div class="inner_gallery">
            <img class="gallery_img under grid_r_1 grid_c_1 img-border" src="static/video/pond.gif " alt="pond"/>
          </div>  
          <h6 class="caption has-tooltip-multiline has-tooltip-bottom">“Beauty of a secluded pond[..]”<span class="tooltip-text">“Beauty of a secluded pond nestled in the heart of woods”</span></h6>
        </div>
        
        <div class="captioned_video">
          <div class="inner_gallery">
            <img class="gallery_img under grid_r_1 grid_c_1 img-border" src="static/video/dolphin.gif " alt="dolphin"/>
          </div>  
          <h6 class="caption has-tooltip-multiline has-tooltip-bottom">“A dolphin leaping [..]”<span class="tooltip-text">“A dolphin leaping [..]”</span></h6>
        </div>

        <div class="captioned_video">
          <div class="inner_gallery">
            <img class="gallery_img under grid_r_1 grid_c_1 img-border" src="static/video/dungeon.gif " alt="dungeon"/>
          </div>  
          <h6 class="caption has-tooltip-multiline has-tooltip-bottom">“Dark, mysterious dungeon[..]”<span class="tooltip-text">“Dark, mysterious dungeon tunnel, dimly lit”</span></h6>
        </div>

        <div class="captioned_video">
          <div class="inner_gallery">
            <img class="gallery_img under grid_r_1 grid_c_1 img-border" src="static/video/piano.gif " alt="piano"/>
          </div>  
          <h6 class="caption has-tooltip-multiline has-tooltip-bottom">“Floating musical notes[..]”<span class="tooltip-text">“Floating musical notes from a piano”</span></h6>
        </div>
        
        <div class="captioned_video">
          <div class="inner_gallery">
            <img class="gallery_img under grid_r_1 grid_c_1 img-border" src="static/video/submarine.gif " alt="submarine"/>
          </div>  
          <h6 class="caption has-tooltip-multiline has-tooltip-bottom">“An underwater submarine”<span class="tooltip-text">“An underwater submarine”</span></h6>
        </div>
        
        <div class="captioned_video">
          <div class="inner_gallery">
            <img class="gallery_img under grid_r_1 grid_c_1 img-border" src="static/video/motorcycle.gif " alt="motorcycle"/>
          </div>  
          <h6 class="caption has-tooltip-multiline has-tooltip-bottom">“A standing motorcycle”<span class="tooltip-text">“A standing motorcycle”</span></h6>
        </div>

      </div>
      <div class="more-results">
        <p class="more-results-text">For more results, please visit <a href="gallery.html", target="_blank">gallery!</a></p>
      </div>
    </div>
  </div>
</section>

<hr class="divider">

<section class="section hero">
  <div class="container is-max-desktop">
    <div class="section-title has-text-centered is-centered">
      <h2 class="title is-3">From Doodles to Details: The Explainability of Sketch Synthesis</h2>
      As shown in the figure below, we demonstrate that our CLIPDrawX model offers the ability to synthesize explainable sketches whose strokes are primitive shapes like circles (second row from the top), straight lines (third row) and half circles (fourth row). These individual strokes can be tracked through their evolution in successive iterations of the optimization process. Notably, the model intuitively represents different parts of the synthesized sketch with appropriate primitive shapes. For example, the chassis and handlebars of the synthesized <em>motorcycle</em> are rendered with straight lines, while the wheels are depicted using circles and semicircles.<br>
      <br>Our model skilfully captures the dynamics of shape or scene evolution, displaying varying levels of flexibility based on the degree of freedom, which is linked to the number of control points in a shape.
      In the <em>farm</em> example, it assigns straight lines to simpler structures like a house's roof and walls, while more complex elements like grass and crops are made with semi-circles, providing more flexibility. Even more intricate structures, like trees, are rendered using circles, the most flexible shape, illustrating the model's skill in using various primitives for different levels of complexity. This strategic use of shapes enhances the model's ability to create detailed, nuanced sketches.
    </div>
    <div class="container is-max-desktop is-centered has-text-centered">
      <div class="gallery2">
        
        <div class="captioned_video">
          <div class="inner_gallery2">
            <img class="gallery2 img-border" src="static/explain/motorcycle.png" alt="motorcycle"/>
          </div>  
          <h6 class="caption has-tooltip-multiline has-tooltip-bottom">“A standing motorcycle”</h6>
        </div>

        <div class="captioned_video">
          <div class="inner_gallery2">
            <img class="gallery2 img-border" src="static/explain/farm.png" alt="farm"/>
          </div>  
          <h6 class="caption has-tooltip-multiline has-tooltip-bottom">“A peaceful afternoon at the farm sketch”</h6>
        </div>

      </div>
      <div class="more-results">
        <p class="more-results-text">For more results, please visit <a href="explain.html", target="_blank">Explainable Sketch Synthesis!</a></p>
      </div>
    </div>
  </div>
</section>

<hr class="divider">
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="section-title has-text-centered is-centered">
      <h2 class="title is-3">Clearing the Clutter: Exploring Patch-based Initialization</h2>
    </div>
    <div class="hero-body">
      <video poster="" id="tree" autoplay controls loop muted height="100%">
        <!-- Your video here -->
        <source src="static/images/Patchification.mp4"
        type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
      Placing different primitives at a single location is problematic, as it may result in clutter due to high point density, leading to uneven primitive distribution and messy sketches. To address this, our CLIPDrawX introduces primitives in fixed ranges or <em>patches</em>, representing all points within, rather than at precise attention map locations. It divides a <mark>\(224 \times 224\)</mark> canvas into patches of <mark>\(32 \times 32\)</mark>. 
      </h2>
    </div>
  </div>
</section>


<hr class="divider">

<section class="section hero">
  <div class="container is-max-desktop">
    <div class="section-title has-text-centered is-centered">
      <h2 class="title is-3">Fundamental Finesse: The Debut of Primitive-level Dropout</h2>
      Primitive-level dropout enhances the utilization of primitive shapes. 

      It facilitates the optimization process in a way that forces every primitive to independently encode some specific concept in the sketch. As a result, the number of noisy strokes in the sketch, that do not contribute towards depicting anything meaningful, is reduced.
      
      Moreover, PLD expedites convergence by reducing the number of steps required for structure creation, thanks to its ability to promptly detect relevant strokes.    <div class="container is-max-desktop is-centered has-text-centered">
      <br>
        <div class="gallery2">
        
        <div class="captioned_video">
          <div class="inner_gallery2">
            <img class="gallery2" src="static/images/dropout_ablation.jpg" alt="dropout"/>
          </div>  
        </div>

      </div>
    </div>
  </div>
</section>

<hr class="divider">
<section class="section hero">
  <div class="container is-max-desktop">
    <div class="section-title has-text-centered is-centered">
      <h2 class="title is-3">Gentle Strokes: Sketching with Diminished Opacity</h2>
      In traditional human sketching, artists often begin with a light outline or faint layout, serving as a foundation for the artwork. This initial phase sets the broader structure and composition. As the artwork advances, artists intensify strokes, especially focusing on crucial elements to make them prominent, ensuring each stroke adds value to the overall piece. Drawing a parallel to the digital realm, in CLIPDrawX, we have curated a similar methodology. Here, the initialization of primitive shapes starts with a low opacity value, denoted as \(\alpha\). This can be likened to the faint layout artists create. As the system begins its optimization process, based on relevance and significance, the opacity of certain primitives is incrementally increased. This mirrors the artist's method of iteratively intensifying strokes that are deemed crucial to the sketch's integrity.
      <br><br>
        <div class="gallery2">
        
        <div class="captioned_video">
          <div class="inner_gallery2">
            <img class="gallery2" src="static/images/motorcycle.png" alt="opacity"/>
          </div>
          <h6 class="caption has-tooltip-multiline has-tooltip-bottom">“A standing motorcycle”</h6>
        </div>

        <div class="captioned_video">
          <div class="inner_gallery2">
            <img class="gallery2" src="static/images/missile.png" alt="opacity"/>
          </div>
          <h6 class="caption has-tooltip-multiline has-tooltip-bottom">“A missile ready to launch”</h6>
        </div>

      </div>
    </div>
  </div>
</section>

<hr class="divider">

<section class="section hero">  
  <div class="container is-max-desktop">
    <div class="section-title has-text-centered is-centered">
      <h2 class="title is-3">Shades of Creativity: Exploring Sketch Variations</h2>
        <div class="gallery2">
        
        <div class="captioned_video">
          <div class="inner_gallery2">
            <img class="gallery2" src="static/images/variations.png" alt="var"/>
          </div>  
        </div>
      </div>

    </div>
  </div>
</section>

<hr class="divider">

<section class="section hero">  
  <div class="container is-max-desktop">
    <div class="section-title has-text-centered is-centered">
      <h2 class="title is-3">Patch Dynamics: The Influence of Primitive Counts</h2>
        <div class="gallery2">
        
        <div class="captioned_video">
          <div class="inner_gallery2">
            <img class="gallery2" src="static/images/stroke_ablation.png" alt="stroke"/>
          </div>  
        </div>
        Exploring the impact of varying primitive counts for each type within selected patches on sketch outcomes with diverse text prompts in CLIPDrawX.
        <ul>
          <li>1. Few primitives yield abstract sketches (rows 1-2).</li>
          <li>2. Optimal detail emerges with 3-4 primitives (rows 3-4).</li>
          <li>3. Excessive counts (row 5) complicate optimization, hindering synthesis.</li>
        </ul>
        The study recommends deploying 3 primitives per type for efficient synthesis, balancing complexity and resource utilization.
      </div>

    </div>
  </div>
</section>

<hr class="divider">

<section class="section hero">  
  <div class="container is-max-desktop">
    <div class="section-title has-text-centered is-centered">
      <h2 class="title is-3">State-of-the-art Comparison</h2>
      Our CLIPDrawX model is compared with three related methods, including \(\textbf{CLIPDraw}\), which synthesizes CLIP-guided text-to-sketches by optimizing Bezier curves; \(\textbf{BigGAN}\), utilizing a pre-trained BigGAN generator for image production, and \(\textbf{VectorFusion}\), employing a text-conditioned diffusion model for vector sketch creation. We maintain the original settings of all these models to ensure a fair comparison. 
      As demonstrated below, our CLIPDrawX produces sketches that are noticeably cleaner than those from CLIPDraw, likely due to our method's use of primitive-level dropout and the initialization of primitives at reduced opacity. 
      The images from BigGAN often lack proper details and appropriate semantics, and the vector sketches from VectorFusion tend to be overly abstract and detail-deficient. 
      In contrast, our CLIPDrawX consistently delivers clean sketches with accurate details and semantics. 
      The reduced noise in our sketches is attributed to the minimized control points, learnable opacity for primitives, and primitive-level dropout, thus reducing the need for manual intervention and parameter adjustments. 
       <br><br>
        <div class="gallery2">
        
        <div class="captioned_video">
          <div class="inner_gallery2">
            <img class="gallery2" src="static/images/comparison.png" alt="comp"/>
          </div>  
        </div>

      </div>
      <div class="more-results">
        <p class="more-results-text">For more results, please visit <a href="SOTA.html", target="_blank">SOTA Comparison!</a></p><br>
      </div> 
    </div>
  </div>
</section>

<hr class="divider">
<section class="section hero">  
  <div class="container is-max-desktop">
    <div class="section-title has-text-centered is-centered">
      <h2 class="title is-3">Final takeaways</h2><br>
      We introduced the notion of explainable sketch synthesis through optimization via simple geometric primitives like straight lines, circles, and semicircles.
      To this end, we presented CLIPDrawX, a model that synthesizes highly expressive sketches in an explainable manner via simple linear transformations (computed through optimization) on such primitives, leveraging novel techniques such as strategic sketch canvas initialization for synthesizing clean sketches, and the introduction of primitive-level dropout for producing sketches
      with low noise, collectively enhance the model's efficiency and output quality.
      The extensive experiments and ablation studies underscore the model's superiority over existing methods, showcasing its capability to produce sketches that are not only aesthetically appealing but also semantically rich and explainable.
      Combining advanced optimization with intuitive design, CLIPDrawX stands out in AI-driven art creation, guiding future progress in Explainable AI and creative computing.
    </div>
  </div>
</section>

<hr class="divider">


<!-- Paper poster -->
<!-- <section class="hero is-small is-light">
  <div class="hero-body">
    <div class="container">
      <h2 class="title">Poster</h2>

      <iframe  src="static/pdfs/sample.pdf" width="100%" height="550">
          </iframe>
        
      </div>
    </div>
  </section> -->
<!--End paper poster -->


<!--BibTex citation -->
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>
        @misc{mathur2023clipdrawx,
          title={CLIPDrawX: Primitive-based Explanations for Text Guided Sketch Synthesis}, 
          author={Nityanand Mathur and Shyam Marjit and Abhra Chaudhuri and Anjan Dutta},
          year={2023},
          eprint={2312.02345},
          archivePrefix={arXiv},
          primaryClass={cs.CV}
    }
      </code></pre>
    </div>
</section>
<!--End BibTex citation -->


  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
           Page credits: <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

  </body>
  </html>
